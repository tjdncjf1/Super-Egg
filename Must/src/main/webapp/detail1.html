<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>jQuery.getJSON demo</title>
  <link rel="stylesheet" href="colorbox.css" />
  <style>
  img {
    height: 200px;
  }
  #result {
    position: relative; 
  }
  .flickr_image { float: left; }
  #contentsImg {
    margin-left: 35%;
  }
  
  </style>
    <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="jquery.colorbox.js"></script>
</head>
<body>

<script>
$(function(){
  $("#searchButton").click(function() {
      var keyword = $("#searchValue").val();
       
      if(!keyword) {
          alert("검색어를 입력하세요.");
          return false;
      }
       
      // proxy에 전달할 URL
      var proxy_url = "http://openapi.naver.com/search?";
          proxy_url += "key=be6c30428660950b9ece4f651a0d2dba";
          proxy_url += "&target=shop";
          proxy_url += "&display=10";
          proxy_url += "&query="+ keyword;
       /* console.log(encodeURIComponent(proxy_url)); */
          
      $.ajax({
          url: "proxy.jsp",
          type: "get",
          data: {"url" : proxy_url},
          dataType: "xml",
          success: function(data){
                  console.log(data);
                  $("#result").empty();
              $(data).find("item").each(function(){
                  var title = $(this).find("title").text();
                  var image = $(this).find("image").text();
                  var min_price = $(this).find("lprice").text();
                  var high_price = $(this).find("hprice").text();
                  var contents = "<div id='content'>"; 
                  contents += "<img src='" + image + "' id='contentsImg' /><br>";	
                  contents += "<label style= 'float: left';>" + min_price + "</label>";
                  contents += "<label style= 'float: right';>" + high_price + "</label><br>";
                  contents += "<input type='button' value='등록'";
                  contents += "</div>";
                  $(contents).appendTo('#v1');
                  
                  var html = "<span>";
                  html += "<a title='" + title + "' + class='lightbox' href='#content'>";
                  html += "<img src='" + image + "'/><br>";
                  html += "</a>";
                  html += "<label><b>" + title + "</b></label><br>";
                  html += "</span>";
                  $(html).appendTo('#result');
              });
              
              $('.lightbox').colorbox({
              	transition:'fade', 
                width: '60%', 
                height: '60%',
                inline: true,
                onComplete: function(){
                  // 이미지 클릭했을 때 close
                  /* $('.cboxPhoto').unbind().click($.colorbox.close); */
                  console.log($('#content'));
                }});
              
          },
           
          error: function(xhr, message, errorThrown){
              var msg = xhr.status + " / " + message + " / " + errorThrown;
               
              alert(msg);
               
          }
      });
       return false;
  });
});
</script>
 <input type="search" id="searchValue">
    <input type="button" value="검색" id="searchButton">
    <div id="result"></div>
    
    <div id = "v1" style="display:none;"></div>
</body>
</html>




